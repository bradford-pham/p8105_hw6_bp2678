---
title: "p8105_hw6_bp2678"
author: "Brady Pham"
date: 2023-11-30
output: github_document
---
```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
library(rvest)
library(broom)
library(purrr)
library(p8105.datasets)
set.seed(1)
```

#Question 2 

```{r}
weather_df = 
  rnoaa::meteo_pull_monitors(
    c("USW00094728"),
    var = c("PRCP", "TMIN", "TMAX"), 
    date_min = "2022-01-01",
    date_max = "2022-12-31") |>
  mutate(
    name = recode(id, USW00094728 = "CentralPark_NY"),
    tmin = tmin / 10,
    tmax = tmax / 10) |>
  select(name, id, everything())
```

#Boot strapped the data and cleaned it

```{r}

boot_strap_results = 
  weather_df |> 
  modelr::bootstrap(n = 5000) |> 
  mutate(
    models = map(strap, ~lm(tmax ~ tmin +prcp, data = .x)),
    results_log = map(models, broom::tidy),
    results_r2 = map(models, broom::glance)
    ) |> 
    unnest(results_log) |> 
     janitor::clean_names() |> 
    select(id:estimate, results_r2) |> 
    pivot_wider(
      names_from = term,
      values_from = estimate
    ) |> 
    mutate(log_b1b2 = log(tmin * prcp)) |> 
 unnest(results_r2) |> 
  janitor::clean_names() |> 
  select(id, r_squared, tmin, prcp, log_b1b2)

```

#Graph for the r2
```{r}
  boot_strap_results |> 
  ggplot(aes(x = r_squared)) + 
  geom_density() +
  labs(title = "Distribution Graph for R2")
```
In the r2 graph it seems to be a normally distributed graph 


#Graph for the log(b1*b2)
```{r}
  boot_strap_results |> 
  ggplot(aes(x = log_b1b2)) + 
  geom_density() +
  labs(title = "Distribution Graph for log(beta1*beta2")
```
In the the log(b1*b2) graph it seems to be left skewd this may be due to some of the data being missing since the negative values were not accounted for. 

```{r}
boot_strap_results |> 
  summarize(
    ci_lower = quantile(r_squared, 0.025), 
    ci_upper = quantile(r_squared, 0.975))
```
The confidence interval for r squared is (.889, .941)

```{r}
boot_strap_results |> 
  summarize(
    ci_lower = quantile(log_b1b2, 0.025, na.rm = TRUE), 
    ci_upper = quantile(log_b1b2, 0.975, na.rm = TRUE))
```
The confidence interval for log(beta1*beta2) is (-8.96, -4.60)


















